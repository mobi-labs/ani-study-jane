#### ğŸ” Reference: [ì›¹ë·°ë¥¼ ì´ìš©í•´ ì›¹ ì„œë¹„ìŠ¤ë¥¼ ì•±ìœ¼ë¡œ ë¹ ë¥´ê²Œ êµ¬í˜„í•˜ê¸° | ì¸í”„ì½˜ 2023](https://www.youtube.com/watch?v=hsh8BS7gyrY&t=522s)

## ì›¹ë·°ë€?

- ì•±ì´ ì›¹ ì»¨í…ì¸ ë¥¼ í‘œì‹œí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë‚´ì¥í˜• ë¸Œë¼ìš°ì €
- Android(Java, Kotlin), iOS(Objective-C, Swift)ì— ëª¨ë‘ ì¡´ì¬í•œë‹¤. Cross Platform(React Native, Flutter)ì—ë§Œ ì¡´ì¬í•˜ëŠ” íŠ¹ì„±ì€ ì•„ë‹ˆê³  ë„¤ì´í‹°ë¸Œ ì–¸ì–´ ìì²´ì—ì„œ ì§€ì›í•˜ëŠ” ì¶”ìƒí™”ëœ interfaceì— í•´ë‹¹í•œë‹¤.
- WebView ë‚´ì—ì„œ ì‹¤í–‰ë˜ëŠ” JavaScriptëŠ” Bridgeë¥¼ í†µí•´ Native ê¸°ë³¸ ì‹œìŠ¤í…œ APIë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.

### Bridge

![image](https://github.com/user-attachments/assets/da386b9c-00b5-4bec-bb3a-cfa3046d96da)

- ë„¤ì´í‹°ë¸Œì™€ ì›¹ë·°ì˜ í†µì‹ ì„ ìœ„í•´ ì œê³µë˜ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì¸í„°í˜ì´ìŠ¤
- ì›¹ë·°ê°€ ì§ì ‘ ë„¤ì´í‹°ë¸Œ APIë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•˜ë¯€ë¡œ Bridgeë¥¼ í†µí•´ ì´ë¥¼ í˜¸ì¶œí•œë‹¤.
- WebView ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬í˜„ì²´ ì—­í• ì„ í•œë‹¤.
  - êµ¬í˜„ì²´: íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ë‚˜ ì¶”ìƒ í´ë˜ìŠ¤ë¥¼ ì‹¤ì œë¡œ êµ¬í˜„í•œ í´ë˜ìŠ¤
  - ë©”ì„œë“œì˜ ì„ ì–¸ë§Œ ìˆê³  ì‹¤ì œ ë™ì‘ì€ ì •ì˜ë˜ì–´ ìˆì§€ ì•Šì€ ì¸í„°í˜ì´ìŠ¤ë‚˜ ì¶”ìƒ í´ë˜ìŠ¤ë¥¼ ì‹¤ì œë¡œ ì‘ë™í•˜ëŠ” í˜•íƒœë¡œ ë§Œë“  í´ë˜ìŠ¤

### ëŒ€í‘œì ì¸ ì›¹ë·°ì˜ í†µì‹  ê°ì²´, PostMessage

`Window.postMessage`ë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ domain window ê°ì²´ë“¤ ê°„ì˜ ì•ˆì „í•œ í†µì‹ ì„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ ì„œë¡œ ë‹¤ë¥¸ ì¶œì²˜(domain, protocol, port)ë¥¼ ê°€ì§„ ì›¹ í˜ì´ì§€ë“¤ ì‚¬ì´ì— ë©”ì„¸ì§€ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

- Window ê°ì²´ ì‚¬ì´ì—ì„œ ì•ˆì „í•˜ê²Œ **Cross-Origin í†µì‹ **ì´ ê°€ëŠ¥í•˜ë‹¤.
  - postMessageë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì¼ ì¶œì²˜ ì •ì±…ìœ¼ë¡œ ì œí•œëœ ì„œë¡œ ë‹¤ë¥¸ ì¶œì²˜(Cross-Origin) ê°„ í†µì‹ ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.
- í˜ì´ì§€ì™€ íŒì—…, í˜ì´ì§€ ë‚´ë¶€ì˜ í˜ì´ì§€ `iframe`ê°„ì˜ í†µì‹ ì— ì‚¬ìš©í•œë‹¤.
  - íŒì—…ì„ ì—´ê±°ë‚˜ `iframe`ì„ ì‚½ì…í•´ ì„œë¡œ ë‹¤ë¥¸ ì¶œì²˜ì˜ ì½˜í…ì¸ ë¥¼ ë¡œë“œí•œ í›„ ë‘ ì¶œì²˜ ê°„ ì •ë³´ë¥¼ ì£¼ê³  ë°›ê³  ì‹¶ì„ ë•Œ postMessageë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
  - ì˜ˆ: YouTube ë¹„ë””ì˜¤ê°€ ì„ë² ë“œ ëœ ì›¹í˜ì´ì§€ì—ì„œ `iframe`ì„ í†µí•´ YouTubeì™€ ì†Œí†µí•˜ëŠ” ê²½ìš°
- `Window.postMessage`ë¥¼ í†µí•´ ì „ë‹¬ëœ ì¸ìëŠ” ì´ë²¤íŠ¸ ê°ì²´ë¥¼ í†µí•´ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
  - ì´ë²¤íŠ¸ ê°ì²´ì˜ ì¼ë¶€ë¡œ ì „ë‹¬ëœ ë©”ì„¸ì§€ë¥¼ `Window.addEventListener("message", callback)`ì„ ì‚¬ìš©í•´ ìˆ˜ì‹ í•˜ê³  ì´ ë°ì´í„°ë¥¼ ë‹¤ë£¬ë‹¤.
  - ë©”ì„¸ì§€ë¥¼ ë³´ë‚¸ ì°½ì—ì„œ postMessageë¡œ ë³´ë‚¸ ë°ì´í„°ë¥¼ ë‹¤ë¥¸ ì°½ì´ë‚˜ `iframe`ì—ì„œ `addEventListener`ë¥¼ í†µí•´ ìˆ˜ì‹  ë° ì²˜ë¦¬í•œë‹¤.
  - `event.data`ë¥¼ í†µí•´ ë©”ì„¸ì§€ ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤. ì´ë•Œ ì ì ˆí•œ ì¶œì²˜ ê²€ì‚¬ë¥¼ í†µí•´ ë³´ì•ˆì„ ìœ ì§€í•´ì•¼ í•œë‹¤.

### ì™œ ì›¹ë·°ì¸ê°€?

- ì›¹ê³¼ ì•±ì„ í•œ ë²ˆì— ê°œë°œí•  ìˆ˜ ìˆì–´ ê°œë°œ ì†ë„ê°€ í–¥ìƒë˜ê³  ì¼ê´€ëœ ì‚¬ìš©ì ê²½í—˜ì„ ì œê³µí•  ìˆ˜ ìˆë‹¤.
- ì•±ì„ ë°°í¬í•˜ì§€ ì•Šì•„ë„ ì›¹ë·°ë¥¼ ìˆ˜ì •í•˜ë©´ ë°˜ì˜ë˜ë¯€ë¡œ ì•± ìŠ¤í† ì–´ ì‹¬ì‚¬ê°€ ë¶ˆí•„ìš”í•˜ë‹¤.
- ë„¤ì´í‹°ë¸Œ ì•±ì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì²˜ëŸ¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
  - ì„¼ì„œ(GPS, Gyro), ì•Œë¦¼, ì¹´ë©”ë¼, ëª¨ë°”ì¼ ì €ì¥ì†Œ ë“± ì‚¬ìš© ê°€ëŠ¥
  - ì¼ì •, ì—°ë½ì²˜ ì ‘ê·¼ ê°€ëŠ¥
  - ì•±ê³¼ ì•± ê°„ì˜ ê³µìœ  ê°€ëŠ¥
  - ì´ì™¸ì˜ ì—¬ëŸ¬ ë„¤ì´í‹°ë¸Œ ì‹œìŠ¤í…œê³¼ì˜ ê¹Šì€ í†µí•© ê°€ëŠ¥

> ğŸ¤” ê¸°ìˆ ì ìœ¼ë¡œ ì›¹ë·°ê°€ ì¢‹ì€ ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œ?

1. ëŸ°íƒ€ì„ ì‹œ ë°œìƒí•˜ëŠ” ì›¹ ì½”ë“œ(ì„ì˜ì˜ ì›¹ ì»¨í…ì¸ )ë¥¼ ê²©ë¦¬í•  ìˆ˜ ìˆë‹¤.

- ì•± ë‚´ë¶€ì—ì„œ ë…ë¦½ëœ í™˜ê²½ì„ ì œê³µí•˜ë¯€ë¡œ ì›¹ ì½˜í…ì¸ ë¥¼ ì•±ì˜ ë©”ì¸ ì½”ë“œë‚˜ ë¡œì§ìœ¼ë¡œë¶€í„° ë¶„ë¦¬í•  ìˆ˜ ìˆë‹¤.
- ê°œë°œìê°€ ì•±ì˜ ì•ˆì •ì„±ê³¼ ì„±ëŠ¥ì„ ìœ ì§€í•˜ë©´ì„œ ì¶”ê°€ì ìœ¼ë¡œ ì™¸ë¶€ ì›¹ ì»¨í…ì¸ ë¥¼ ë¡œë“œí•  ìˆ˜ ìˆë‹¤.
- íŠ¹ì • JavaScript ì½”ë“œì˜ ì‹¤í–‰ì„ ì œí•œí•˜ê±°ë‚˜ ì½˜í…ì¸  í•„í„°ë§ì„ í†µí•´ ë³´ì•ˆ ìœ„í—˜ì„ ì°¨ë‹¨í•˜ëŠ” ë“± ì™¸ë¶€ì—ì„œ ë¡œë“œëœ ì›¹ í˜ì´ì§€ê°€ ì•±ì˜ ë¯¼ê°í•œ ê¸°ëŠ¥ì— ì§ì ‘ ì ‘ê·¼í•˜ì§€ ëª»í•˜ê²Œ í•  ìˆ˜ ìˆë‹¤.

2. ì›¹ê³¼ ì•±ì— ì¢…ì†ë˜ì§€ ì•ŠëŠ”ë‹¤.

- ë…ë¦½ëœ ë¸Œë¼ìš°ì§• í™˜ê²½ì„ ì œê³µí•˜ì—¬ ê¸°ë³¸ ë¸Œë¼ìš°ì €ë‚˜ í”Œë«í¼ì— ì¢…ì†ë˜ì§€ ì•Šê³  ê°œë°œìê°€ ì›¹ë·°ì˜ ë™ì‘ì„ ì¬ì •ì˜í•  ìˆ˜ ìˆë‹¤.
- ë¡œë“œë˜ëŠ” ì½˜í…ì¸ ì— ëŒ€í•œ ë³´ì•ˆ ì •ì±…ì„ ìì²´ì ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.
- ì‚¬ìš©ì ì¶”ì  ë°©ì§€, ì¿ í‚¤ ê´€ë¦¬ ë“± ë¸Œë¼ìš°ì €ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ë“¤ì„ ì•± ìì²´ì—ì„œ í†µì œí•  ìˆ˜ ìˆë‹¤.

3. ì›¹ê³¼ ì•±ì˜ í†µì‹  ë°©ë²•ì„ ë‹¤ì–‘í•˜ê²Œ ì ìš©í•  ìˆ˜ ìˆë‹¤.

- íŠ¹ì • í”Œë«í¼ì— ì¢…ì†ë˜ì§€ ì•Šê³  ì•±ê³¼ ì›¹ í˜ì´ì§€ ê°„ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ì„ ìˆ˜ ìˆë‹¤.
- ë™ì¼í•œ ì›¹ í‘œì¤€ ê¸°ë°˜ìœ¼ë¡œ ì‘ë™í•˜ì—¬ ë‹¤ë¥¸ í”Œë«í¼ ê°„ì— ë™ì¼í•œ í†µì‹  ë°©ì‹ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- ì›¹ë·° ë‚´ë¶€ì˜ ì›¹ í˜ì´ì§€ì—ì„œ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸ë¥¼ ì•±ìœ¼ë¡œ ì „ë‹¬í•˜ê±°ë‚˜ ì•±ì´ íŠ¹ì • ë°ì´í„°ë¥¼ ì›¹ìœ¼ë¡œ ë³´ë‚´ëŠ” ì‘ì—…ì„ í”Œë«í¼ì— ìƒê´€ì—†ì´ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

## React Native WebView

### Bridge Way

- ì›¹ í˜ì´ì§€ì™€ React Native ì• í”Œë¦¬ì¼€ì´ì…˜ ê°„ ì–‘ë°©í–¥ í†µì‹ ì´ ê°€ëŠ¥í•˜ë„ë¡ í•œë‹¤.
- JavaScriptë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„ëœ ì½”ë“œë¡œ, ì›¹ ì½˜í…ì¸ ì™€ ë„¤ì´í‹°ë¸Œ ì½”ë“œ ê°„ì˜ ìƒí˜¸ì‘ìš©ì´ ê°€ëŠ¥í•˜ë„ë¡ ì—°ê²°í•œë‹¤.

> í”„ë¡œí¼í‹° (Properties)

- WebView ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ì‹œ ì„¤ì •ë˜ëŠ” ì„¤ì • ê°’ì´ë‚˜ event handler
- ì£¼ë¡œ WebViewì˜ **ì´ˆê¸° ì„¤ì •ì´ë‚˜ ì´ë²¤íŠ¸ ìˆ˜ì‹ **ì„ ìœ„í•´ ì‚¬ìš©í•œë‹¤.
- WebView ì»´í¬ë„ŒíŠ¸ ì„ ì–¸ ì‹œ ì„¤ì •í•œë‹¤.
- JSX ì†ì„±ìœ¼ë¡œ ì „ë‹¬í•œë‹¤.

> ë©”ì„œë“œ (Methods)

- WebView ë Œë”ë§ ì´í›„ ì–¸ì œë“ ì§€(ë™ì ìœ¼ë¡œ) í˜¸ì¶œ ê°€ëŠ¥í•œ í•¨ìˆ˜
- WebViewì˜ ë™ì‘ì„ **ë™ì ìœ¼ë¡œ ì œì–´**í•˜ê±°ë‚˜ **ë°ì´í„°ë¥¼ ì „ì†¡**í•  ë•Œ ì‚¬ìš©í•œë‹¤.
- ì°¸ì¡°(`ref`)ë¥¼ í†µí•´ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.

#### React Native â¡ï¸ Web

> [`injectedJavaScript` Property](https://github.com/react-native-webview/react-native-webview/blob/master/docs/Reference.md#injectedjavascript)

- WebView ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” JavaScript ì½”ë“œë¥¼ ì •ì˜í•œë‹¤.
- ì´ˆê¸° ë¡œë”© ì‹œì ì— í•œ ë²ˆ ì‹¤í–‰ë˜ëŠ” ì½”ë“œì´ë‹¤.
- WebViewì— íŠ¹ì • ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì…í•´ í˜ì´ì§€ ë¡œë“œ ì§í›„ ì‹¤í–‰ë˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.

|   Type   | Required |           Platform           |
| :------: | :------: | :--------------------------: |
| `string` |    X     | iOS, Android, macOS, Windows |

- ì‚½ì…ë˜ëŠ” ë¬¸ìì—´ì´ ìœ íš¨í•œ íƒ€ì…ìœ¼ë¡œ í‰ê°€ë˜ê³  ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ì§€ ì•Šë„ë¡ ì£¼ì˜í•´ì„œ ì‚½ì…í•´ì•¼ í•œë‹¤.
- `onMessage` í•¸ë“¤ëŸ¬ë¥¼ ë°˜ë“œì‹œ ì„¤ì •í•´ì•¼ í•œë‹¤.
  - ì•„ë¬´ ë™ì‘ë„ í•˜ì§€ ì•ŠëŠ” í•¸ë“¤ëŸ¬ë¼ë„ ì„¤ì •í•´ì•¼ ì½”ë“œê°€ ì‹¤í–‰ëœë‹¤.
  - ì´ë¥¼ í†µí•´ ì „ì†¡ëœ ë©”ì„¸ì§€ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” ê²½ë¡œë¥¼ ì„¤ì •í•˜ê³  ë©”ì„¸ì§€ê°€ ì˜¬ë°”ë¥´ê²Œ ì „ë‹¬ë˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.
- `WKUserScriptInjectionTimeAtDocumentEnd` (iOS)
  - iOSì˜ **WKWebView**ì—ì„œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì£¼ì…í•  ì‹œì ì„ ì§€ì •í•˜ëŠ” ì—´ê±°í˜• ìƒìˆ˜
  - ë¬¸ì„œ ë¡œë”©ì´ ì™„ë£Œëœ ì‹œì ì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì£¼ì…í•˜ë„ë¡ ì„¤ì •í•œë‹¤.
  - `injectedJavaScript` ë‚´ë¶€ì ìœ¼ë¡œ í•´ë‹¹ ìƒìˆ˜ë¥¼ ì‚¬ìš©í•´ iOSì—ì„œì˜ ì£¼ì… ì‹œì ì„ ê²°ì •í•˜ë¯€ë¡œ `injectedJavaScript` í”„ë¡œí¼í‹°ì— JavaScript ì½”ë“œë¥¼ ì„¤ì •í•˜ë©´ `WKUserScriptInjectionTimeAtDocumentEnd`ì™€ ë™ì¼í•œ ì‹œì ì— ì›¹ í˜ì´ì§€ì— ì£¼ì…ëœë‹¤.
  - ì›¹ í˜ì´ì§€ì˜ DOMì´ ì™„ì „íˆ ë¡œë“œëœ í›„ ì¶”ê°€ì ì¸ í•˜ìœ„ ë¦¬ì†ŒìŠ¤(ì´ë¯¸ì§€ ë“±)ê°€ ë¡œë“œë˜ê¸° ì „ JavaScript ì½”ë“œê°€ ì‹¤í–‰ëœë‹¤.
- WindowsëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `alert`ë¥¼ ì§€ì›í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— window í™˜ê²½ì—ì„œ ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤.

<hr/>

```js
const INJECTED_JAVASCRIPT = `(function() {
    window.ReactNativeWebView.postMessage(JSON.stringify(window.location));
})();`;

<WebView
  source={{ uri: "https://ani.com" }}
  injectedJavaScript={INJECTED_JAVASCRIPT}
  onMessage={this.onMessage}
/>;
```

1. `WebView` ì»´í¬ë„ŒíŠ¸ê°€ `https://ani.com`ë¡œ í˜ì´ì§€ë¥¼ ë¡œë“œí•œë‹¤.
2. í˜ì´ì§€ ë¡œë“œ ì´í›„ WebViewëŠ” `injectedJavaScriptë¡œ ì •ì˜ëœ JavaScript ì½”ë“œë¥¼ ì‹¤í–‰í•œë‹¤.
3. `INJECTED_JAVASCRIPT`ê°€ ì‹¤í–‰ëœë‹¤.

- í˜„ì¬ í˜ì´ì§€ì˜ `window.location` ê°ì²´ë¥¼ `JSON.stringify`ë¥¼ í†µí•´ JSON ë¬¸ìì—´ë¡œ ë³€í™˜í•œë‹¤.
- ìœ„ ì‘ì—…ì˜ ê²°ê³¼ë¥¼ `postMessage`ë¥¼ í†µí•´ React Native WebViewë¡œ ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•œë‹¤.
- `window.location` ê°ì²´ëŠ” í˜„ì¬ ì›¹ í˜ì´ì§€ì˜ URL ê´€ë ¨ ì •ë³´ë¥¼ í¬í•¨í•œë‹¤.
  ```js
  {
    href: "https://ani.com",
    protocol: "https:",
    host: "ani.com",
    hostname: "ani.com",
    pathname: "/",
    origin: "https://ani.com",
    //...
  }
  ```

4. `onMessage` í•¸ë“¤ëŸ¬ê°€ í˜¸ì¶œëœë‹¤.

> [`injectJavaScript` Method](https://github.com/react-native-webview/react-native-webview/blob/master/docs/Reference.md#injectjavascriptstr)

- WebView ë¡œë“œ ì´í›„ JavaScript ì½”ë“œë¥¼ ì–¸ì œë“ ì§€ ë™ì ìœ¼ë¡œ ì‚½ì…í•˜ê³  ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ë©”ì„œë“œ
- ì‚¬ìš©ì ìƒí˜¸ ì‘ìš©ì´ë‚˜ íŠ¹ì • ì¡°ê±´ì— ë”°ë¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•œë‹¤.

```js
const webviewRef = useRef(null);

const runScript = () => {
  webviewRef.current?.injectJavaScript(
    `window.alert("ğŸ–¥ï¸ ë™ì ìœ¼ë¡œ ì‚½ì…ëœ JavaScript ì½”ë“œ");`
  );
};

return (
  <>
    <WebView ref={webviewRef} source={{ uri: "https://ani.com" }} />
    <Button title='ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰' onPress={runScript} />
  </>
);
```

1. `https://ani.com` ì›¹ í˜ì´ì§€ê°€ `WebView` ë‚´ì—ì„œ ë¡œë“œëœë‹¤.
2. ì‚¬ìš©ìê°€ `ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰` ë²„íŠ¼ì„ í´ë¦­í•œë‹¤.
3. `runScript` í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤.

- `webviewRef.current?.injectJavaScript`ë¥¼ ì‚¬ìš©í•´ WebViewì— JavaScript ì½”ë“œë¥¼ ì£¼ì…í•œë‹¤.

4. `injectJavaScript` ë©”ì„œë“œê°€ í˜¸ì¶œëœë‹¤.

- WebView ë‚´ì—ì„œ ì£¼ì…í•œ JavaScript ì½”ë“œê°€ ì‹¤í–‰ëœë‹¤.
- ì‹¤í–‰ ê²°ê³¼: ì›¹ í˜ì´ì§€ ë‚´ì—ì„œ `ğŸ–¥ï¸ ë™ì ìœ¼ë¡œ ì‚½ì…ëœ JavaScript ì½”ë“œ`ë¼ëŠ” ë‚´ìš©ì˜ ì•Œë¦¼ ì°½ì´ íŒì—…ëœë‹¤.

#### Web â¡ï¸ React Native

> [`onMessage` Property](https://github.com/react-native-webview/react-native-webview/blob/master/docs/Reference.md#onmessage)

- WebView ë‚´ì˜ JavaScript ì½”ë“œì—ì„œ `postMessage`ë¥¼ í†µí•´ ì „ì†¡ëœ ë©”ì„¸ì§€ë¥¼ ìˆ˜ì‹ í•˜ëŠ” ì½œë°± í•¨ìˆ˜
- WebViewì—ì„œ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

```js
<WebView
  source={{ uri: "https://ani.com" }}
  onMessage={(event) => {
    const message = event.nativeEvent.data;
    console.log("ğŸ“± WebViewë¡œë¶€í„° ë©”ì‹œì§€ ìˆ˜ì‹ :", message);
  }}
/>
```

> [`postMessage` Method](https://github.com/react-native-webview/react-native-webview/blob/master/docs/Reference.md#postmessagestr)

- ë„¤ì´í‹°ë¸Œ ì½”ë“œì—ì„œ WebViewë¡œ ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•˜ëŠ” ë©”ì„œë“œ
- ë„¤ì´í‹°ë¸Œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì›¹ í˜ì´ì§€ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ê±°ë‚˜ íŠ¹ì • ë™ì‘ì„ ì§€ì‹œí•  ìˆ˜ ìˆë‹¤.

```js
const webviewRef = useRef(null);

const sendMessage = () => {
  webviewReã…£;
  ã…‡f.current?.postMessage("Hello World!:)");
};

return (
  <>
    <WebView
      ref={webviewRef}
      source={{ uri: "https://ani.com" }}
      onMessage={(event) => {
        console.log("ğŸ“± WebViewë¡œë¶€í„° ë©”ì‹œì§€ ìˆ˜ì‹ :", event.nativeEvent.data);
      }}
    />
    <Button title='ë©”ì‹œì§€ ë³´ë‚´ê¸°' onPress={sendMessage} />
  </>
);
```

#### ğŸ¤” ì–´ë–¤ íë¦„ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆì„ê¹Œ?

```js
import React, { useRef } from "react";
import { WebView } from "react-native-webview";

const MyWebViewComponent = () => {
  const webviewRef = useRef(null);

  const handleOnMessage = (event) => {
    // WebViewì—ì„œ ì „ë‹¬ëœ ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬
    console.log("ğŸ–¥ï¸ ì›¹ë·°ì—ì„œ ì „ë‹¬ëœ ë©”ì„¸ì§€:", event.nativeEvent.data);
  };

  const sendMessageToWebView = () => {
    // React Nativeì—ì„œ WebViewë¡œ ë©”ì‹œì§€ ë³´ë‚´ê¸°
    webviewRef.current?.injectJavaScript(
      `window.alert("ğŸ“± React Nativeì—ì„œ ì „ë‹¬ëœ ë©”ì„¸ì§€!");`
    );
  };

  return (
    <>
      <WebView
        ref={webviewRef}
        source={{ uri: "https://example.com" }}
        onMessage={handleOnMessage}
      />
      <Button title='ë©”ì‹œì§€ ë³´ë‚´ê¸°' onPress={sendMessageToWebView} />
    </>
  );
};
```

> 1. ì›¹ í˜ì´ì§€ì—ì„œ React Nativeë¡œ ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•œë‹¤.

ì›¹ í˜ì´ì§€ì—ì„œ ì‹¤í–‰ë˜ëŠ” JavaScriptëŠ” `window.ReactNativeWebView.postMessage()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ React Nativeë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•œë‹¤.

```js
window.ReactNativeWebView.postMessage("Hello from WebView!");
```

> 2. React Nativeì—ì„œ ì›¹ í˜ì´ì§€ë¡œ ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•œë‹¤.

React Native ì• í”Œë¦¬ì¼€ì´ì…˜ì€ `injectJavaScript()` ë©”ì„œë“œ ë“±ì„ ì‚¬ìš©í•˜ì—¬ WebViewì— ìˆëŠ” ì›¹ í˜ì´ì§€ë¡œ ë©”ì„¸ì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆë‹¤.

```js
const webviewRef = useRef(null);

// WebViewë¡œ ë©”ì‹œì§€ ë³´ë‚´ê¸°
webviewRef.current?.injectJavaScript(
  `alert("ğŸ“± React Nativeì—ì„œ ì „ë‹¬ëœ ë©”ì„¸ì§€!");`
);
```

> 3. `onMessage` í•¸ë“¤ëŸ¬

React NativeëŠ” `onMessage` í•¸ë“¤ëŸ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ WebViewë¡œë¶€í„° ì „ë‹¬ëœ ë©”ì„¸ì§€ë¥¼ ë°›ëŠ”ë‹¤.

```js
<WebView
  source={{ uri: "https://ani.com" }}
  // ì›¹í˜ì´ì§€ì—ì„œ ë³´ë‚´ëŠ” ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•˜ì—¬ ì²˜ë¦¬í•œë‹¤.
  onMessage={(event) => {
    console.log("ğŸ–¥ï¸ ì›¹ë·°ì—ì„œ ì „ë‹¬ëœ ë©”ì„¸ì§€:", event.nativeEvent.data);
  }}
/>
```

##

##
